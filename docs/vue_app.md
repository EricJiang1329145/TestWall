# Vue 应用说明

## 应用功能

该Vue应用用于从校园墙服务器获取帖子数据并以JSON格式显示。

## 技术实现

### 主要组件

1. **App.vue** - 主应用组件
   - 使用 `fetch` API 从 `/api/get_messages` 获取数据
   - 显示加载状态、错误信息和数据内容
   - 提供刷新数据功能

### 核心功能

1. **数据获取**
   - 在组件挂载时自动获取数据
   - 用户可手动刷新数据

2. **状态管理**
   - 加载状态：显示加载提示
   - 错误状态：显示错误信息和重试按钮
   - 成功状态：显示JSON格式的数据

3. **数据展示**
   - 以格式化的JSON形式显示帖子数据
   - 支持横向滚动查看长内容

4. **错误处理和模拟数据**
   - 当无法从服务器获取数据时，提供错误信息显示
   - 提供模拟数据功能，用于开发和测试
   - 可以在真实数据和模拟数据之间切换

### 核心方法

1. `fetchMessages()` - 获取帖子数据的主要方法
2. `toggleMockData()` - 在真实数据和模拟数据之间切换

## 代码结构

```
src/
├── App.vue          # 主组件
├── main.ts          # 应用入口
└── vite-env.d.ts    # 类型定义
```

## CORS问题和解决方案

### 问题描述
在开发环境中，前端Vue应用可能会遇到CORS（跨域资源共享）限制，导致无法从浏览器直接访问后端API。

### 解决方案
Vue应用通过Vite的代理功能解决CORS问题：

1. 在`vite.config.ts`中配置代理：
   ```javascript
   server: {
     proxy: {
       '/api': {
         target: 'https://www.rz101.com',
         changeOrigin: true,
         rewrite: (path) => path.replace(/^\/api/, '/api')
       }
     }
   }
   ```

2. 在前端代码中使用相对路径访问API：
   ```javascript
   fetch("/api/get_messages")
   ```

通过以上配置，前端应用可以通过`http://localhost:1420/api/get_messages`访问后端API，而不会遇到CORS限制。

## 常见问题和解决方案

### 1. 网络错误 (net::ERR_FAILED)
当出现 `net::ERR_FAILED https://www.rz101.com/api/get_messages` 错误时，可能是以下原因：
- 服务器暂时不可用
- 网络连接问题
- CORS（跨域资源共享）限制

**解决方案：**
- 点击"使用模拟数据"按钮切换到模拟数据模式
- 检查网络连接
- 稍后重试

### 2. CORS 错误
如果在浏览器控制台看到 CORS 相关错误，说明存在跨域访问限制。

**解决方案：**
- 使用"使用模拟数据"功能进行开发测试
- 联系服务器管理员配置 CORS 策略

## 修改记录

### 2025-09-14
- 为帖子评论区添加单独的滚动显示功能，设置最大高度300px，溢出部分可滚动
- 优化滚动条样式，添加平滑滚动效果和滚动条美化
- 同时支持深色模式和浅色模式下的滚动条样式
- 确保评论区域在评论过多时保持界面美观

### 2025-04-05
- 实现从服务器获取帖子数据并显示JSON内容
- 添加了加载状态和错误处理
- 添加了刷新数据功能
- 添加了模拟数据功能和真实/模拟数据切换功能
- 改进了错误处理和用户界面
- 添加了CORS问题的解决方案